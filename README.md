# Text-Based MIDI Disassembly for Harmony-Aware AI Melody Regeneration

*A Reproducible SOP for Singing Synthesis Education*
## Overview
This repository provides a **reproducible, text-based workflow** for AI-assisted melody regeneration that preserves the original accompaniment of a MIDI song.
The proposed SOP is designed specifically for **singing synthesis education**, where instructors require multiple melodic variants while maintaining identical harmony, rhythm, tempo, and structural form.

Rather than generating music end-to-end, this approach operates directly on **existing multi-track MIDI files** by disassembling them into a human-readable text format. A large language model (LLM) is then instructed to regenerate **only the designated melody channel**, optionally informed by harmonic context from accompaniment tracks. The edited text is finally reassembled into a valid MIDI file without post-processing.

This repository accompanies the paper:

> **A Text-Based MIDI Disassembly Approach to AI Melody Regeneration in Singing Synthesis Education**
> Hung-Che Shen, I-Shou University
---
## Key Contributions
* A **deterministic SOP** for AI-assisted melody variation based on symbolic MIDI text
* Harmony-aware melody regeneration while **preserving accompaniment intact**
* Model-agnostic design compatible with multiple LLMs (GPT, Grok, Gemini)
* Fully reproducible educational examples using a canonical children’s song (*Two Tigers*)
* Publicly available MIDI, TXT, and workflow documentation for teaching and research
---
## Toolchain
This workflow is built upon the legacy but deterministic utility:
### MIDI File Disassembler/Assembler
A program to convert MIDI files into readable text files that can be viewed and edited with any text editor, and to convert the edited text files back into standard MIDI files.
Beyond simple conversion, the tool supports extensive symbolic processing, including:
* Filtering MIDI events by channel or note range
* Remapping note numbers
* Scaling velocity values
* Delaying tracks
* Preserving or selectively removing event types
**Prerequisites (required):**
* MidiFile DLL
* GenMidi DLL
Both DLLs must be installed before using the Disassembler/Assembler.
**Original source (archived):**
[https://web.archive.org/web/20080129082157/http://www.borg.com/~jglatt/progs/software.htm](https://web.archive.org/web/20080129082157/http://www.borg.com/~jglatt/progs/software.htm)
This repository redistributes the tools **unchanged**, strictly for research and educational use.
---
## Repository Structure
```
midi-txt-melody-regeneration-sop/
│
├─ tools/                # MIDI File Disassembler/Assembler and DLLs
│
├─ demo/
│   ├─ original/         # Original MIDI and extracted track text
│   └─ regenerated/     # AI-regenerated melody variants (TXT + MIDI)
│
├─ workflow/             # Step-by-step SOP documentation
│
├─ paper/                # Figures, tables, and case study materials
│
└─ appendix/             # Format notes, limitations, reproducibility checklist
```
---
## Standard Operating Procedure (SOP)
### Step 1. MIDI Disassembly
* Convert a standard multi-track MIDI file into text using the **[Make Text]** function.
* The resulting MIDI-TEXT file preserves all event-level information (pitch, timing, channel, tempo).
### Step 2. Track-Level Inspection
* Identify the **melody track** (e.g., Track #1 / Channel 1).
* Identify accompaniment tracks (e.g., harmony or bass on Track #2).
* No timing or structural edits are performed at this stage.
### Step 3. Harmony-Aware Melody Regeneration
* Provide the complete MIDI-TEXT to an LLM.
* Instruct the model to regenerate **only the melody channel**.
* Optional constraints include:
  * Pitch range
  * Maximum melodic interval
  * Stepwise preference
  * Awareness of accompaniment chord tones
All other channels, timing, and formatting must remain unchanged.
### Step 4. MIDI Reassembly
* Convert the modified MIDI-TEXT back into a standard MIDI file using **[Make MIDI]**.
* The resulting file is immediately usable in singing synthesis systems.
---
## Demonstration Case Study
The demo uses an 8-bar children’s song (*Two Tigers*) to illustrate three levels of melody variation:
1. **Additive Variation**
   Preserves contour with additional passing tones.
2. **Contour-Based Variation**
   Alters melodic shape while maintaining rhythmic structure.
3. **Harmony-Functional Variation**
   Regenerates melody with clear chord-tone interaction, highlighting harmonic function.
All regenerated MIDI files:
* Preserve original accompaniment exactly
* Maintain identical note onsets and durations
* Are fully reassembled without MIDI errors
---
## Educational Motivation
In singing synthesis education, instructors often reuse high-quality accompaniments generated by commercial tools. However, manually recomposing melodies for each pedagogical scenario is inefficient.
This repository demonstrates an alternative SOP where:
* AI assists **melody variation only**
* Instructors remain reviewers and listeners
* Symbolic transparency ensures trust and reproducibility
The concept of **singability** is treated as a practical constraint, enforced through symbolic parameters rather than subjective style prompts.
---
## Limitations
* The workflow operates at the symbolic MIDI level and does not generate audio directly.
* Harmonic awareness is implicit, derived from accompaniment tracks rather than explicit chord labels.
* Expressive parameters (dynamics, articulation) are not yet included.
These limitations are discussed in detail in the accompanying paper.
---
## Citation
If you use this repository in academic work, please cite the accompanying paper.
A `CITATION.cff` file is provided for reference managers.
---
## License and Disclaimer
This repository is intended for **research and educational purposes only**.
The MIDI File Disassembler/Assembler is redistributed in accordance with its original terms as archived. Users are responsible for ensuring appropriate usage rights for any MIDI content they process.
---
## Contact
Hung-Che Shen
Department of Emerging Media Design
I-Shou University, Taiwan
Email: [shungch@isu.edu.tw](mailto:shungch@isu.edu.tw)
